## Course

In this example, we will try to retrieve more information from the NoSQL database.

Using a bit of guess work (or previous knowledge of the application), we can deduce that there is probably a password field.

We can play around to confirm that suspicion:

- if we access `/?search=admin'%20%26%26%20this.password.match(/.\*/)%00]()`: we can see a result.
- if we access `/?search=admin'%20%26%26%20this.password.match(/zzzzz/)%00]()`: we cannot see a result.
- if we access `/?search=admin'%20%26%26%20this.passwordzz.match(/.\*/)%00]()`: we get an error message (since the field passwordzz does not exist).

Now, we have a way to perform a blind injection since we have two states:

- No result when the regular expression does not match something: `false` state.
- One result when the regular expression matches something: `true` state.

Using this knowledge, we can script the exploitation to retrieve the `admin` password.

We will first ensure that the matching is done correctly by using: ^ and $ to make sure we do not match characters in the middle of the string (otherwise iterating will be far harder).

The algorithm looks like:

- test if password match `/^a._$/` if it matches test without the wildcard `._`(to check if it's the full password). Then move to the next letter if it does not match.
- test if password match `/^b._$/` if it matches test without the wildcard `._.` Then move to the next letter if it does not match.

For example, if the password is aab, the following test will be performed:

- `/^a.\*$/` that will return `true`.
- `/^a$/` that will return `false`.
- `/^aa.\*$/` that will return `true`.
- `/^aa$/` that will return `false`.
- `/^aaa.\*$/` that will return `false`.
- `/^aab.\*$/` that will return `true`.
- `/^aab$/` that will return `true`. The password has been found.

With these details, you should be able to retrieve the password for the user `admin`. The password is the key to solve this exercises,
